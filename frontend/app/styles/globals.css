@import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Fredoka:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
 body {
   @apply bg-base-100 text-base-content min-h-screen font-sans;
  }

 h1, h2, h3, h4, h5, h6 {
   @apply font-heading;
 }

 [data-style-mode="realistic"] h1, [data-style-mode="realistic"] h2, [data-style-mode="realistic"] h3, [data-style-mode="realistic"] h4, [data-style-mode="realistic"] h5, [data-style-mode="realistic"] h6 {
   @apply font-cinematic;
 }

 [data-style-mode="realistic"] body {
   @apply font-cinematic;
 }
}

@layer components {
 /* 涂鸦风格卡片 */
 .card-doodle {
   @apply bg-base-100 border-3 border-base-content/30 rounded-xl shadow-brutal transition-all duration-200;
  }
 .card-doodle:hover {
   @apply shadow-brutal-lg -translate-x-0.5 -translate-y-0.5;
  }

 /* 电影级风格卡片 */
 .card-cinematic {
   @apply bg-base-100 border border-base-300 rounded-xl shadow-cinematic transition-all duration-300 backdrop-blur-sm;
 }
 .card-cinematic:hover {
   @apply shadow-cinematic-lg scale-[1.02];
 }

 /* 涂鸦风格按钮 */
 .btn-doodle {
   @apply border-3 border-base-content/30 rounded-lg shadow-brutal font-bold uppercase tracking-wide transition-all duration-150;
  }
 .btn-doodle:hover {
   @apply shadow-brutal-hover -translate-x-0.5 -translate-y-0.5;
  }
 .btn-doodle:active {
   @apply shadow-none translate-x-1 translate-y-1;
  }

 /* 电影级风格按钮 */
 .btn-cinematic {
   @apply border border-base-300 rounded-lg shadow-cinematic-sm font-medium transition-all duration-300 bg-gradient-to-r from-primary/10 to-secondary/10 hover:from-primary/20 hover:to-secondary/20;
 }
 .btn-cinematic:hover {
   @apply shadow-cinematic-glow;
 }

 /* 涂鸦风格输入框 */
 .input-doodle {
   @apply border-3 border-base-content/30 rounded-lg bg-base-100 outline-none focus:border-primary;
  }

 /* 电影级风格输入框 */
 .input-cinematic {
   @apply border border-base-300 rounded-lg bg-base-200 outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-300;
 }

 /* 手绘下划线效果 */
 .underline-sketch {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 10'%3E%3Cpath d='M0 8 Q 25 2, 50 8 T 100 8' stroke='%23FFDE59' stroke-width='3' fill='none'/%3E%3C/svg%3E");
    background-repeat: repeat-x;
    background-position: bottom;
    background-size: 100px 10px;
    padding-bottom: 8px;
  }

 /* 电影级渐变边框效果 */
 .border-gradient {
   position: relative;
   background: linear-gradient(var(--tw-gradient-stops));
 }
 .border-gradient::before {
   content: "";
   position: absolute;
   inset: 0;
   border-radius: inherit;
   padding: 1px;
   background: linear-gradient(135deg, #3B82F6, #8B5CF6, #EC4899);
   -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
   mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
   -webkit-mask-composite: xor;
   mask-composite: exclude;
 }

 /* 涂鸦装饰 - 星星 */
 .doodle-star::before {
    content: "✦";
   @apply absolute -top-2 -right-2 text-primary text-xl animate-pulse;
  }

 /* 涂鸦装饰 - 圆圈 */
 .doodle-circle {
   @apply relative;
  }
 .doodle-circle::after {
    content: "";
   @apply absolute -inset-2 border-2 border-dashed border-secondary rounded-full opacity-50;
  }

 /* 电影级光晕效果 */
 .glow-effect {
   @apply relative overflow-hidden;
 }
 .glow-effect::before {
   content: "";
   position: absolute;
   inset: -2px;
   background: linear-gradient(45deg, #3B82F6, #8B5CF6, #EC4899, #3B82F6);
   background-size: 400% 400%;
   animation: glow-rotate 3s linear infinite;
   z-index: -1;
   border-radius: inherit;
   filter: blur(8px);
   opacity: 0.6;
 }
 @keyframes glow-rotate {
   0% { background-position: 0% 50%; }
   50% { background-position: 100% 50%; }
   100% { background-position: 0% 50%; }
 }
}

@layer utilities {
 /* 手绘边框效果 */
 .border-sketch {
    border-radius: 255px 15px 225px 15px/15px 225px 15px 255px;
  }

 /* 抖动动画 */
 .animate-wiggle {
    animation: wiggle 0.3s ease-in-out infinite;
  }

 @keyframes wiggle {
    0%, 100% { transform: rotate(-1deg); }
    50% { transform: rotate(1deg); }
  }

 /* 弹跳进入 */
 .animate-bounce-in {
    animation: bounce-in 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

 @keyframes bounce-in {
    0% { transform: scale(0); opacity: 0; }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); opacity: 1; }
  }

 /* 水平弹跳动画 */
 .animate-bounce-x {
    animation: bounce-x 1s infinite;
  }

 @keyframes bounce-x {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(-8px); }
  }

 /* 淡入动画 */
 .animate-fade-in {
    animation: fade-in 0.3s ease-out;
  }

 @keyframes fade-in {
    0% { opacity: 0; transform: translateY(-4px); }
    100% { opacity: 1; transform: translateY(0); }
  }

 /* 消息滑入动画 */
 .animate-slide-in-left {
    animation: slide-in-left 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

 .animate-slide-in-right {
    animation: slide-in-right 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

 @keyframes slide-in-left {
    0% { opacity: 0; transform: translateX(-16px); }
    100% { opacity: 1; transform: translateX(0); }
  }

 @keyframes slide-in-right {
    0% { opacity: 0; transform: translateX(16px); }
    100% { opacity: 1; transform: translateX(0); }
  }

 /* 进度条闪光效果 */
 .animate-shimmer {
    animation: shimmer 2s infinite;
  }

 @keyframes shimmer {
    0% { opacity: 0; }
    50% { opacity: 1; }
    100% { opacity: 0; }
  }

 /* 点状背景 - 黑色背景白色小点正方形排列 */
 .bg-dots {
    background-image: radial-gradient(rgba(255, 255, 255, 0.2) 1px, transparent 1px);
    background-size: 20px 20px;
    background-color: #000;
  }
}

/* 减少动画偏好 */
@media (prefers-reduced-motion: reduce) {
 .animate-wiggle,
 .animate-bounce-in,
 .animate-bounce-x,
 .animate-fade-in,
 .animate-slide-in-left,
 .animate-slide-in-right,
 .animate-shimmer {
    animation: none;
  }
}

/* ========== tldraw 无限画布样式覆盖 ========== */

/* 画布容器 */
.infinite-canvas-container {
  @apply w-full h-full;
}

.infinite-canvas-container .tl-container {
  --tl-font-family: 'Nunito', 'Comic Neue', sans-serif;
  background: transparent !important;
}

/* tldraw 背景层 - 使用点状背景，根据主题自动调整颜色 */
/* 浅色主题 */
[data-theme="doodle"] .infinite-canvas-container .tl-background {
  background-image: radial-gradient(rgba(0, 0, 0, 0.2) 1px, transparent 1px) !important;
  background-size: 20px 20px !important;
  background-color: #FFFEF0 !important;
}

/* 深色主题 */
[data-theme="doodle-dark"] .infinite-canvas-container .tl-background {
  background-image: radial-gradient(rgba(255, 255, 255, 0.2) 1px, transparent 1px) !important;
  background-size: 20px 20px !important;
  background-color: #1a1a1a !important;
}

/* 电影级深色主题 */
[data-theme="cinematic"] .infinite-canvas-container .tl-background {
  background: linear-gradient(135deg, #0B0F19 0%, #111827 50%, #0B0F19 100%) !important;
  background-image: 
    radial-gradient(rgba(59, 130, 246, 0.03) 1px, transparent 1px),
    linear-gradient(135deg, #0B0F19 0%, #111827 50%, #0B0F19 100%) !important;
  background-size: 24px 24px, 100% 100% !important;
}

/* 电影级浅色主题 */
[data-theme="cinematic-light"] .infinite-canvas-container .tl-background {
  background: linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 50%, #F8FAFC 100%) !important;
  background-image: 
    radial-gradient(rgba(37, 99, 235, 0.05) 1px, transparent 1px),
    linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 50%, #F8FAFC 100%) !important;
  background-size: 24px 24px, 100% 100% !important;
}

/* 隐藏 tldraw 默认 UI */
.infinite-canvas-container .tlui-layout__top,
.infinite-canvas-container .tlui-layout__bottom,
.infinite-canvas-container .tlui-navigation-panel,
.infinite-canvas-container .tlui-help-menu,
.infinite-canvas-container .tlui-debug-panel,
.infinite-canvas-container .tlui-menu-panel,
.infinite-canvas-container .tlui-style-panel {
  display: none !important;
}

/* 隐藏 tldraw 水印 */
.infinite-canvas-container .tlui-watermark,
.infinite-canvas-container [class*="watermark"],
.infinite-canvas-container .tl-watermark,
.infinite-canvas-container .tlui-watermark__inner {
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Shape 容器样式 */
.infinite-canvas-container .tl-shape-container {
  /* 确保 Tailwind 类在 Shape 内生效 */
}

/* 隐藏选中状态指示器（自定义 shapes 已通过 hideSelectionBoundsFg/Bg 禁用） */
.infinite-canvas-container .tl-selection__fg,
.infinite-canvas-container .tl-selection__bg {
  display: none !important;
}

/* 禁用 tldraw 内部的 hover 效果，使用自定义的 card-doodle hover */
.infinite-canvas-container .tl-shape:hover {
  /* 不添加额外效果 */
}

/* 确保 Modal 在 tldraw 之上 */
.infinite-canvas-container ~ [class*="modal"],
.infinite-canvas-container ~ [class*="fixed"] {
  z-index: 9999 !important;
}
